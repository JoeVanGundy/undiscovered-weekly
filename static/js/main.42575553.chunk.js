(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,a){e.exports=a(22)},19:function(e,t,a){},21:function(e,t,a){},22:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(10),i=a.n(r),o=(a(19),a(8)),l=a.n(o),c=a(11),u=a(7),p=a(2),d=a(3),h=a(5),m=a(4),y=a(1),b=a(6),g=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).state={playlists:{}},a.changeSelect=a.changeSelect.bind(Object(y.a)(a)),a.savePlaylist=a.savePlaylist.bind(Object(y.a)(a)),a}return Object(b.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.getUsersPlaylist()}},{key:"getUsersPlaylist",value:function(){var e=this;this.props.spotifyApi.getUserPlaylists({limit:50}).then(function(t){e.setState({playlists:t})})}},{key:"createNewPlaylist",value:function(){var e=this;return this.props.spotifyApi.getMe().then(function(t){return e.props.spotifyApi.createPlaylist(t.id,{name:"Undiscovered Weekly"})})}},{key:"savePlaylist",value:function(e){var t=this;""===this.props.chosenPlaylist&&this.createNewPlaylist().then(function(e){t.props.selectCreatedPlaylist(e.id)}).then(function(e){t.props.replacePlaylist()}),this.props.replacePlaylist()}},{key:"changeSelect",value:function(e){this.props.onPlaylistSelect(e)}},{key:"render",value:function(){var e=this,t=[];return void 0!==this.state.playlists.items&&(t=Object.keys(this.state.playlists.items).map(function(t){return s.a.createElement("option",{id:e.state.playlists.items[t].id},e.state.playlists.items[t].name)})),s.a.createElement("div",{class:"card text-white bg-dark mb-3"},s.a.createElement("div",{class:"card-header"},s.a.createElement("h4",null,"Where you like to save your playlist?")),s.a.createElement("div",{class:"card-body"},s.a.createElement("div",{class:"input-group",style:{width:"50%",marginRight:"auto",marginLeft:"auto"}},s.a.createElement("select",{class:"custom-select",onChange:this.changeSelect},s.a.createElement("option",{selected:!0,id:"default",value:!0},"---Create New Playlist---"),t),s.a.createElement("div",{class:"input-group-append"},s.a.createElement("button",{class:"btn btn-secondary",type:"button",onClick:this.savePlaylist},"Save Playlist")))))}}]),t}(s.a.Component),v=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).state={recommendations:[],topTracks:[],topArtists:[],chosenPlaylist:"",availableGenres:["acoustic","afrobeat","alt-rock","alternative","ambient","anime","black-metal","bluegrass","blues","bossanova","brazil","breakbeat","british","cantopop","chicago-house","children","chill","classical","club","comedy","country","dance","dancehall","death-metal","deep-house","detroit-techno","disco","disney","drum-and-bass","dub","dubstep","edm","electro","electronic","emo","folk","forro","french","funk","garage","german","gospel","goth","grindcore","groove","grunge","guitar","happy","hard-rock","hardcore","hardstyle","heavy-metal","hip-hop","holidays","honky-tonk","house","idm","indian","indie","indie-pop","industrial","iranian","j-dance","j-idol","j-pop","j-rock","jazz","k-pop","kids","latin","latino","malay","mandopop","metal","metal-misc","metalcore","minimal-techno","movies","mpb","new-age","new-release","opera","pagode","party","philippines-opm","piano","pop","pop-film","post-dubstep","power-pop","progressive-house","psych-rock","punk","punk-rock","r-n-b","rainy-day","reggae","reggaeton","road-trip","rock","rock-n-roll","rockabilly","romance","sad","salsa","samba","sertanejo","show-tunes","singer-songwriter","ska","sleep","songwriter","soul","soundtracks","spanish","study","summer","swedish","synth-pop","tango","techno","trance","trip-hop","turkish","work-out","world-music"]},a.updateRecommendations=a.updateRecommendations.bind(Object(y.a)(a)),a.onPlaylistSelect=a.onPlaylistSelect.bind(Object(y.a)(a)),a.replacePlaylist=a.replacePlaylist.bind(Object(y.a)(a)),a.getUsersPlaylist=a.getUsersPlaylist.bind(Object(y.a)(a)),a.selectCreatedPlaylist=a.selectCreatedPlaylist.bind(Object(y.a)(a)),a}return Object(b.a)(t,e),Object(d.a)(t,[{key:"getUsersPlaylist",value:function(){this.props.spotifyApi.getUserPlaylists().then(function(e){})}},{key:"onPlaylistSelect",value:function(e){this.setState({chosenPlaylist:e.target.options[e.target.selectedIndex].id})}},{key:"selectCreatedPlaylist",value:function(e){this.setState({chosenPlaylist:e})}},{key:"replacePlaylist",value:function(e){this.props.spotifyApi.replaceTracksInPlaylist(this.state.chosenPlaylist,this.getTrackUris(e)).then(function(e){})}},{key:"getSelectedGenres",value:function(){return 0!=this.props.selectedGenres.length?this.props.selectedGenres.join(","):this.props.usersFavoriteGenress}},{key:"getRecommendationsFromGenres",value:function(){for(var e=[],t=0;t<5;t++)e.push(this.props.spotifyApi.getRecommendations({seed_genres:this.getSelectedGenres(),max_popularity:100,limit:100}));return Promise.all(e)}},{key:"getRecommendationsFromGenres",value:function(){for(var e=[],t=0;t<5;t++)e.push(this.props.spotifyApi.getRecommendations({seed_genres:this.getSelectedGenres(),max_popularity:100,limit:100}));return Promise.all(e)}},{key:"getArtistsFromRecommendations",value:function(e){var t=[];return e.forEach(function(e){t.push(e.artists[0].id)}),Object(u.a)(new Set(t))}},{key:"getArtistsTopTracks",value:function(e){var t=this,a=[];return e.map(function(e,n){a.push(t.props.spotifyApi.getArtistTopTracks(e.id,"US"))}),Promise.all(a)}},{key:"getArtistsFromRecommendations",value:function(e){var t=[];return e.forEach(function(e){t.push(e.artists[0].id)}),Object(u.a)(new Set(t))}},{key:"getUnpopularArtists",value:function(e,t){var a=[];return e.forEach(function(e){e.popularity<t&&a.push(e)}),a.length=30,a}},{key:"getArtists",value:function(e){var t,a,n,s=[];for(t=0,a=e.length;t<a;t+=50)n=e.slice(t,t+50),s.push(this.props.spotifyApi.getArtists(n));return Promise.all(s)}},{key:"getTopTrackFromArtistsTopTracks",value:function(e){var t=[];return e.forEach(function(e){e.tracks.length>0&&t.push(e.tracks[0])}),t}},{key:"flatten",value:function(e,t){for(var a=[],n=0;n<e.length;n++)a="tracks"===t?a.concat(e[n].tracks):a.concat(e[n].artists);return a}},{key:"getTrackUris",value:function(){var e=[];return this.state.recommendations.forEach(function(t){e.push(t.uri)}),e}},{key:"updateRecommendations",value:function(){var e=this;this.getRecommendationsFromGenres().then(function(t){var a=e.getArtistsFromRecommendations(JSON.parse(JSON.stringify(e.flatten(t,"tracks"))));return e.getArtists(a)}).then(function(t){var a=e.getUnpopularArtists(JSON.parse(JSON.stringify(e.flatten(t,"artists"))),e.props.maxPopularity);return e.getArtistsTopTracks(a)}).then(function(t){var a=e.getTopTrackFromArtistsTopTracks(t);e.setState({recommendations:a})})}},{key:"componentDidMount",value:function(){this.updateRecommendations()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("div",{class:"card text-white bg-dark mb-3"},s.a.createElement("div",{class:"card-body"},s.a.createElement("button",{type:"button",className:"btn btn-secondary",onClick:function(){return e.updateRecommendations()}},"Get New Recommendations"),s.a.createElement("table",{class:"table table-dark table-hover"},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,"#"),s.a.createElement("th",null,"Artist"),s.a.createElement("th",null,"Title"),s.a.createElement("th",null,"Album"),s.a.createElement("th",null,"Top Track Popularity"))),s.a.createElement("tbody",null,this.state.recommendations.map(function(e,t){return s.a.createElement("tr",null,s.a.createElement("td",null,t+1),s.a.createElement("td",null,e.artists[0].name),s.a.createElement("td",null,e.name),s.a.createElement("td",null,e.album.name),s.a.createElement("td",null,e.popularity))}))))),s.a.createElement(g,{spotifyApi:this.props.spotifyApi,onPlaylistSelect:this.onPlaylistSelect,replacePlaylist:this.replacePlaylist,selectCreatedPlaylist:this.selectCreatedPlaylist,chosenPlaylist:this.state.chosenPlaylist}))}}]),t}(s.a.Component),f=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).state={playlists:{},selectedTab:null},a.handleSelect=a.handleSelect.bind(Object(y.a)(a)),a}return Object(b.a)(t,e),Object(d.a)(t,[{key:"handleSelect",value:function(e){this.setState({selectedTab:e.target.id});var t=50;switch(e.target.id){case"lowMainstream":t=40;break;case"middleMainstream":t=60;break;case"highMainstream":t=80;break;default:t=50}this.props.handlePopularityChange(t)}},{key:"isActive",value:function(e){return this.state.selectedTab===e?"btn btn-secondary active":"btn btn-secondary"}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("div",{class:"card text-white bg-dark mb-3"},s.a.createElement("div",{class:"card-header"},s.a.createElement("h4",null,"How mainstream would you like your playlist?")),s.a.createElement("div",{class:"card-body"},s.a.createElement("div",{class:"btn-group btn-group-toggle","data-toggle":"buttons",onChange:this.handleSelect},s.a.createElement("label",{className:this.isActive("lowMainstream")},s.a.createElement("input",{type:"radio",name:"options",id:"lowMainstream",autocomplete:"off"}),"Not Mainstream"),s.a.createElement("label",{className:this.isActive("middleMainstream")},s.a.createElement("input",{type:"radio",name:"options",id:"middleMainstream",autocomplete:"off"}),"Somewhere in the middle"),s.a.createElement("label",{className:this.isActive("highMainstream")},s.a.createElement("input",{type:"radio",name:"options",id:"highMainstream",autocomplete:"off"}),"Mainstream")))))}}]),t}(s.a.Component),k=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(m.a)(t).call(this,e))).handleCheck=a.handleCheck.bind(Object(y.a)(a)),a.state={chooseFavorite:!1},a.toggleUseFavorite=a.toggleUseFavorite.bind(Object(y.a)(a)),a}return Object(b.a)(t,e),Object(d.a)(t,[{key:"handleCheck",value:function(e){this.props.handleGenreCheck(e)}},{key:"isActive",value:function(e){return this.props.selectedGenres.includes(e)?"btn btn-secondary active":"btn btn-secondary"}},{key:"toggleUseFavorite",value:function(e){this.setState({chooseFavorite:e.target.checked})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{class:"card text-white bg-dark mb-3"},s.a.createElement("div",{class:"card-header"},s.a.createElement("h4",null,"We determined your favorite genres are: ",this.props.favoriteGenres),s.a.createElement("div",{class:"custom-control custom-switch"},s.a.createElement("input",{type:"checkbox",class:"custom-control-input",id:"customSwitch1",onChange:this.toggleUseFavorite}),s.a.createElement("label",{class:"custom-control-label",for:"customSwitch1"},"Would you like to customize your favorite genres?"))),this.state.chooseFavorite&&s.a.createElement("div",{class:"card-body"},s.a.createElement("div",{class:"btn-group-toggle","data-toggle":"buttons"},this.props.genres.map(function(t){return s.a.createElement("label",{style:{margin:"5px"},className:e.isActive(t)},s.a.createElement("input",{type:"checkbox",class:"custom-control-input",autocomplete:"off",id:t,onClick:e.handleCheck}),t)}))))}}]),t}(s.a.Component),E=(a(21),a(12)),w=new(a.n(E).a),P=["user-read-private","user-read-email","user-read-playback-state","user-top-read","playlist-modify-public"],j=window.location.hash.substring(1).split("&").reduce(function(e,t){if(t){var a=t.split("=");e[a[0]]=decodeURIComponent(a[1])}return e},{});window.location.hash="";var O=function(e){function t(){var e;Object(p.a)(this,t);var a=(e=Object(h.a)(this,Object(m.a)(t).call(this))).getHashParams().access_token;return e.state={token:null,loggedIn:!!a,selectedGenres:[],usersFavoriteGenres:[],maxPopularity:50,availableGenres:["acoustic","afrobeat","alt-rock","alternative","ambient","anime","black-metal","bluegrass","blues","bossanova","brazil","breakbeat","british","cantopop","chicago-house","children","chill","classical","club","comedy","country","dance","dancehall","death-metal","deep-house","detroit-techno","disco","disney","drum-and-bass","dub","dubstep","edm","electro","electronic","emo","folk","forro","french","funk","garage","german","gospel","goth","grindcore","groove","grunge","guitar","happy","hard-rock","hardcore","hardstyle","heavy-metal","hip-hop","holidays","honky-tonk","house","idm","indian","indie","indie-pop","industrial","iranian","j-dance","j-idol","j-pop","j-rock","jazz","k-pop","kids","latin","latino","malay","mandopop","metal","metal-misc","metalcore","minimal-techno","movies","mpb","new-age","new-release","opera","pagode","party","philippines-opm","piano","pop","pop-film","post-dubstep","power-pop","progressive-house","psych-rock","punk","punk-rock","r-n-b","rainy-day","reggae","reggaeton","road-trip","rock","rock-n-roll","rockabilly","romance","sad","salsa","samba","sertanejo","show-tunes","singer-songwriter","ska","sleep","songwriter","soul","soundtracks","spanish","study","summer","swedish","synth-pop","tango","techno","trance","trip-hop","turkish","work-out","world-music"]},e.onGenreCheck=e.onGenreCheck.bind(Object(y.a)(e)),e.handlePopularityChange=e.handlePopularityChange.bind(Object(y.a)(e)),e}return Object(b.a)(t,e),Object(d.a)(t,[{key:"handlePopularityChange",value:function(e){this.setState({maxPopularity:e})}},{key:"onGenreCheck",value:function(e){var t=this;if(this.state.selectedGenres.includes(e.target.id))this.setState({selectedGenres:this.state.selectedGenres.filter(function(a,n){return n!==t.state.selectedGenres.indexOf(e.target.id)})});else{if(this.state.selectedGenres.length>4)return;this.setState({selectedGenres:[].concat(Object(u.a)(this.state.selectedGenres),[e.target.id])})}}},{key:"getHashParams",value:function(){var e,t={},a=/([^&;=]+)=?([^&;]*)/g,n=window.location.hash.substring(1);for(e=a.exec(n);e;)t[e[1]]=decodeURIComponent(e[2]),e=a.exec(n);return t}},{key:"getUsersTopGenres",value:function(){var e=Object(c.a)(l.a.mark(function e(){var t,a,n,s;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.availableGenres,e.next=3,w.getMyTopArtists({limit:50,time_range:"short_term"});case 3:return a=e.sent,n={},a.items.forEach(function(e){e.genres.forEach(function(e){(e=e.replace(" ","-")).split("-").forEach(function(e){t.includes(e)&&(e in n?n[e]++:n[e]=1)})})}),s=Object.keys(n).sort(function(e,t){return n[t]-n[e]}),e.abrupt("return",s.slice(0,5).join(","));case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillMount",value:function(){var e=this,t=j.access_token;t&&(w.setAccessToken(t),this.setState({token:t}),this.getUsersTopGenres().then(function(t){e.setState({usersFavoriteGenres:t})}))}},{key:"render",value:function(){var e;return e=this.state.usersFavoriteGenres.length>0?s.a.createElement(v,{spotifyApi:w,maxPopularity:this.state.maxPopularity,selectedGenres:this.state.selectedGenres,usersFavoriteGenress:this.state.usersFavoriteGenres}):null,s.a.createElement("div",{class:"container",className:"App"},!this.state.token&&s.a.createElement("div",{class:"text-white bg-dark mb-3"},s.a.createElement("a",{className:"btn btn--login App-link",href:"".concat("https://accounts.spotify.com/authorize","?client_id=").concat("670b1531e1d74e8c97c3c81aaa6fc9b0","&redirect_uri=").concat("https://joevangundy.github.io/undiscovered-weekly/","&scope=").concat(P.join("%20"),"&response_type=token&show_dialog=true")},"Login to Spotify")),this.state.token&&s.a.createElement("div",null,s.a.createElement("div",{class:"jumbotron"},s.a.createElement("h1",null,"Undiscovered Weekly")),s.a.createElement(k,{genres:this.state.availableGenres,handleGenreCheck:this.onGenreCheck,favoriteGenres:this.state.usersFavoriteGenres,selectedGenres:this.state.selectedGenres}),s.a.createElement(f,{handlePopularityChange:this.handlePopularityChange}),e),s.a.createElement("footer",{id:"sticky-footer",class:"py-4 bg-dark text-white-50"},s.a.createElement("div",{class:"container text-center"},s.a.createElement("small",null,"Made by Joe Van Gundy"))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(O,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[13,1,2]]]);
//# sourceMappingURL=main.42575553.chunk.js.map